<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Concierge Widget Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            background: linear-gradient(135deg, #fdf2f8 0%, #fff 50%);
            min-height: 100vh;
        }
        h1 {
            color: #831843;
        }
        .info-box {
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        .info-box h2 {
            color: #be185d;
            margin-top: 0;
        }
        code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 14px;
        }
        pre {
            background: #1f2937;
            color: #f9fafb;
            padding: 16px;
            border-radius: 8px;
            overflow-x: auto;
        }
        .test-area {
            height: 400px;
            background: #f3f4f6;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #6b7280;
        }
        .arrow {
            position: fixed;
            bottom: 100px;
            right: 100px;
            font-size: 48px;
            animation: bounce 1s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
    </style>
</head>
<body>
    <h1>Wedding Concierge Widget Test</h1>

    <div class="info-box">
        <h2>How to Test</h2>
        <p>The chat widget bubble should appear in the bottom-right corner of this page.</p>
        <p>Click it to open the embedded chat interface.</p>
    </div>

    <div class="info-box">
        <h2>Embed Code Example</h2>
        <p>Add this before the closing <code>&lt;/body&gt;</code> tag:</p>
        <pre>&lt;script src="http://localhost:3000/widget.js"
        data-wedding="YOUR_ACCESS_CODE"&gt;&lt;/script&gt;</pre>
    </div>

    <div class="info-box">
        <h2>Customization Options</h2>
        <ul>
            <li><code>data-wedding</code> - Required. Your wedding access code.</li>
            <li><code>data-color</code> - Optional. Primary color (default: #f43f5e)</li>
            <li><code>data-position</code> - Optional. "left" or "right" (default: right)</li>
        </ul>
    </div>

    <div class="test-area">
        <p>Scroll down and look for the chat bubble in the bottom-right corner</p>
    </div>

    <div class="arrow">ðŸ‘‡</div>

    <!-- Widget Script - Uses localhost for testing -->
    <script>
        // For local testing, we'll inline a modified version of the widget
        (function() {
            'use strict';

            // LOCAL TESTING: Use localhost instead of production
            var WIDGET_HOST = 'http://localhost:3000';

            // For testing, use a sample access code (replace with real one)
            var accessCode = 'test123';
            var primaryColor = '#f43f5e';
            var position = 'right';

            // Styles
            var styles = document.createElement('style');
            styles.textContent = `
                #wc-widget-container {
                    position: fixed;
                    bottom: 20px;
                    ${position === 'left' ? 'left: 20px;' : 'right: 20px;'}
                    z-index: 999999;
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                }

                #wc-widget-button {
                    width: 60px;
                    height: 60px;
                    border-radius: 50%;
                    background: ${primaryColor};
                    border: none;
                    cursor: pointer;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
                    transition: transform 0.2s, box-shadow 0.2s;
                }

                #wc-widget-button:hover {
                    transform: scale(1.05);
                    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
                }

                #wc-widget-button svg {
                    width: 28px;
                    height: 28px;
                    fill: white;
                }

                #wc-widget-button.open svg.chat-icon { display: none; }
                #wc-widget-button:not(.open) svg.close-icon { display: none; }

                #wc-widget-iframe-container {
                    display: none;
                    position: absolute;
                    bottom: 70px;
                    ${position === 'left' ? 'left: 0;' : 'right: 0;'}
                    width: 380px;
                    height: 520px;
                    background: white;
                    border-radius: 16px;
                    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
                    overflow: hidden;
                }

                #wc-widget-iframe-container.open {
                    display: block;
                    animation: wc-slide-up 0.3s ease-out;
                }

                @keyframes wc-slide-up {
                    from { opacity: 0; transform: translateY(10px); }
                    to { opacity: 1; transform: translateY(0); }
                }

                #wc-widget-iframe {
                    width: 100%;
                    height: 100%;
                    border: none;
                }

                #wc-widget-header {
                    background: ${primaryColor};
                    color: white;
                    padding: 12px 16px;
                    display: flex;
                    align-items: center;
                    justify-content: space-between;
                }

                #wc-widget-header-title { font-weight: 600; font-size: 14px; }

                #wc-widget-header-close {
                    background: none;
                    border: none;
                    color: white;
                    cursor: pointer;
                    padding: 4px;
                }
            `;
            document.head.appendChild(styles);

            // Create widget
            var container = document.createElement('div');
            container.id = 'wc-widget-container';

            var iframeContainer = document.createElement('div');
            iframeContainer.id = 'wc-widget-iframe-container';

            var header = document.createElement('div');
            header.id = 'wc-widget-header';
            header.innerHTML = `
                <span id="wc-widget-header-title">Wedding Concierge</span>
                <button id="wc-widget-header-close">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 6L6 18M6 6l12 12"/>
                    </svg>
                </button>
            `;

            var iframe = document.createElement('iframe');
            iframe.id = 'wc-widget-iframe';
            iframe.src = WIDGET_HOST + '/chat/' + encodeURIComponent(accessCode) + '?embed=true';

            iframeContainer.appendChild(header);
            iframeContainer.appendChild(iframe);

            var button = document.createElement('button');
            button.id = 'wc-widget-button';
            button.innerHTML = `
                <svg class="chat-icon" viewBox="0 0 24 24">
                    <path d="M21 11.5a8.38 8.38 0 01-.9 3.8 8.5 8.5 0 01-7.6 4.7 8.38 8.38 0 01-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 01-.9-3.8 8.5 8.5 0 014.7-7.6 8.38 8.38 0 013.8-.9h.5a8.48 8.48 0 018 8v.5z"/>
                </svg>
                <svg class="close-icon" viewBox="0 0 24 24">
                    <path d="M18 6L6 18M6 6l12 12" stroke="white" stroke-width="2" fill="none"/>
                </svg>
            `;

            container.appendChild(iframeContainer);
            container.appendChild(button);
            document.body.appendChild(container);

            var isOpen = false;
            function toggleWidget() {
                isOpen = !isOpen;
                button.classList.toggle('open', isOpen);
                iframeContainer.classList.toggle('open', isOpen);
            }

            button.addEventListener('click', toggleWidget);
            document.getElementById('wc-widget-header-close').addEventListener('click', function(e) {
                e.stopPropagation();
                toggleWidget();
            });
        })();
    </script>
</body>
</html>
